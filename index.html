<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>GrumpyLinks ‚Äî Find Startup Ideas from Real Customer Complaints</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<script src="env-config.js"></script>
<style>
:root {
  /* Light Mode - Notion + Untitled UI Color Palette */
  --bg-primary: #F8FAFC;
  --bg-secondary: #FFFFFF;
  --bg-tertiary: #F1F5F9;
  --bg-card: #FFFFFF;
  --bg-card-hover: #FFFFFF;
  --bg-input: #FFFFFF;
  --bg-button: #2563EB;
  --bg-button-hover: #1D4ED8;
  --bg-success: #10B981;
  --bg-warning: #F59E0B;
  --bg-danger: #EF4444;
  
  --text-primary: #111827;
  --text-secondary: #6B7280;
  --text-muted: #9CA3AF;
  --text-accent: #2563EB;
  
  --border-primary: #E5E7EB;
  --border-secondary: #D1D5DB;
  --border-accent: #2563EB;
  
  /* Platform colors */
  --reddit: #ff4500; --twitter: #1da1f2; --linkedin: #0077b5; --hackernews: #ff6600; --github: #111827;
  --stackoverflow: #f48024; --medium: #111827; --quora: #b92b27; --youtube: #ff0000; --producthunt: #da552f;
  --discord: #5865f2; --glassdoor: #10b981; --trustpilot: #10b981; --appstore: #007aff; --tiktok: #111827;
  --source-default: #6B7280;
}

/* Dark Mode Variables */
.dark-mode {
  --bg-primary: #0F1115;
  --bg-secondary: #131720;
  --bg-tertiary: #171B26;
  --bg-card: #151A23;
  --bg-card-hover: #181E2A;
  --bg-input: #111623;
  --bg-button: #2563EB;
  --bg-button-hover: #1D4ED8;
  --bg-success: #10B981;
  --bg-warning: #F59E0B;
  --bg-danger: #EF4444;
  
  --text-primary: #E6E9EF;
  --text-secondary: #9AA3B2;
  --text-muted: #7A8494;
  --text-accent: #3B82F6;
  
  --border-primary: #1E2433;
  --border-secondary: #263146;
  --border-accent: #3B82F6;
  
  /* Dark mode platform colors */
  --github: #24292f; --medium: #242424; --tiktok: #000000;
  --source-default: #9AA3B2;
}

/* Dark Mode Toggle */
.dark-mode-toggle {
  position: fixed;
  top: 24px;
  right: 24px;
  z-index: 1000;
  background: var(--bg-card);
  border: 1px solid var(--border-primary);
  border-radius: 8px;
  padding: 8px;
  cursor: pointer;
  transition: all 0.15s ease;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-secondary);
}

.dark-mode-toggle:hover {
  background: var(--bg-card-hover);
  border-color: var(--border-secondary);
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.dark-mode-toggle::before {
  content: "üåô";
  font-size: 16px;
}

.dark-mode .dark-mode-toggle::before {
  content: "‚òÄÔ∏è";
}

* { 
  box-sizing: border-box; 
  margin: 0; 
  padding: 0;
  scrollbar-width: thin;
  scrollbar-color: var(--border-secondary) transparent;
}

*::-webkit-scrollbar { height: 8px; width: 8px; }
*::-webkit-scrollbar-thumb { background: var(--border-secondary); border-radius: 4px; }
*::-webkit-scrollbar-track { background: transparent; }

::selection {
  background: rgba(37, 99, 235, 0.15);
  color: var(--text-primary);
}

.dark-mode ::selection {
  background: rgba(59, 130, 246, 0.25);
  color: var(--text-primary);
}

body { 
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Inter, Arial, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  font-size: 14px;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  letter-spacing: -0.011em;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.app { display: flex; min-height: 100vh; }

.sidebar { 
  width: 320px; 
  background: var(--bg-secondary); 
  border-right: 1px solid var(--border-primary); 
  padding: 24px; 
  overflow-y: auto; 
  flex-shrink: 0;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
  transition: background-color 0.2s ease, border-color 0.2s ease;
}

.dark-mode .sidebar {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.logo { 
  display: flex; 
  flex-direction: column;
  align-items: center; 
  text-decoration: none; 
  color: var(--text-primary);
  font-weight: 700; 
  font-size: 20px; 
  margin-bottom: 8px; 
  padding: 0; 
  gap: 8px;
  transition: color 0.2s ease;
}
.logo-emoji { 
  font-size: 48px; 
  line-height: 1;
  margin: 0;
}
.logo-text {
  margin: 0;
  font-weight: 700;
  text-align: center;
}

.logo-rant {
  font-size: 16px;
  font-weight: 600;
  margin: 4px 0 8px 0;
  line-height: 1.4;
  color: var(--text-primary);
  transition: color 0.2s ease;
  text-align: center;
}

.logo-subtitle {
  font-size: 13px;
  color: var(--text-secondary);
  margin: 0 0 24px 0;
  line-height: 1.5;
  transition: color 0.2s ease;
}

.search-section { margin-bottom: 24px; }

.section-title { 
  font-size: 11px; 
  font-weight: 600; 
  color: var(--text-muted); 
  text-transform: uppercase; 
  letter-spacing: 0.05em; 
  margin-bottom: 8px;
  transition: color 0.2s ease;
}

/* Unified input styles */
.search-input, 
.select-input,
.query-dropdown,
.filter-select { 
  width: 100%; 
  background: var(--bg-input); 
  border: 1px solid var(--border-primary);
  border-radius: 8px; 
  color: var(--text-primary); 
  font-weight: 400; 
  transition: all 0.15s ease; 
  font-family: inherit; 
  margin-bottom: 12px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .search-input,
.dark-mode .select-input,
.dark-mode .query-dropdown,
.dark-mode .filter-select {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.search-input { 
  padding: 12px 16px; 
  font-size: 14px; 
}

.select-input { 
  padding: 12px 16px; 
  font-size: 13px; 
  cursor: pointer; 
  margin-bottom: 12px; 
}

.search-input:hover,
.select-input:hover,
.query-dropdown:hover,
.filter-select:hover {
  border-color: var(--border-secondary);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.dark-mode .search-input:hover,
.dark-mode .select-input:hover,
.dark-mode .query-dropdown:hover,
.dark-mode .filter-select:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.search-input:focus, 
.select-input:focus,
.query-dropdown:focus,
.filter-select:focus { 
  outline: none; 
  border-color: var(--border-accent);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .search-input:focus,
.dark-mode .select-input:focus,
.dark-mode .query-dropdown:focus,
.dark-mode .filter-select:focus {
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2), 0 1px 2px rgba(0, 0, 0, 0.2);
}

.search-input::placeholder { 
  color: var(--text-muted); 
  transition: color 0.2s ease;
}

.search-button { 
  width: 100%; 
  background: var(--bg-button); 
  color: white; 
  border: none;
  padding: 14px 24px;
  border-radius: 8px; 
  font-size: 14px; 
  font-weight: 600; 
  cursor: pointer; 
  transition: all 0.15s ease;
  font-family: inherit; 
  letter-spacing: -0.011em;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .search-button {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.search-button:hover { 
  background: var(--bg-button-hover); 
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(37, 99, 235, 0.25);
}

.search-button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.25);
}

.main-content { 
  flex: 1; 
  padding: 56px 32px; 
  overflow-y: auto; 
  max-width: 1120px;
  margin: 0 auto;
  width: 100%;
}

.results-header { 
  margin-bottom: 48px; 
  text-align: center;
}

.results-title { 
  font-size: 48px; 
  font-weight: 700; 
  margin-bottom: 16px; 
  color: var(--text-primary);
  letter-spacing: -0.025em;
  line-height: 1.1;
  transition: color 0.2s ease;
}

.results-subtitle { 
  color: var(--text-secondary); 
  font-size: 18px;
  font-weight: 400;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
  transition: color 0.2s ease;
}

/* Smart Filters and Sorting Controls */
.results-controls {
  background: var(--bg-card);
  border: 1px solid var(--border-primary);
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 32px;
  display: none;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
  transition: all 0.2s ease;
}

.dark-mode .results-controls {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.controls-row {
  display: flex;
  flex-wrap: wrap;
  gap: 24px;
  align-items: center;
  justify-content: space-between;
}

.filter-group {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

.filter-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-right: 12px;
  transition: color 0.2s ease;
}

.filter-btn {
  background: var(--bg-secondary);
  color: var(--text-secondary);
  border: 1px solid var(--border-primary);
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  font-family: inherit;
  white-space: nowrap;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .filter-btn {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.filter-btn:hover {
  background: var(--bg-tertiary);
  border-color: var(--border-secondary);
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.dark-mode .filter-btn:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.filter-btn.active {
  background: var(--bg-button);
  color: white;
  border-color: var(--bg-button);
  box-shadow: 0 2px 4px rgba(37, 99, 235, 0.25);
}

.sort-group {
  display: flex;
  align-items: center;
  gap: 12px;
}

.sort-select {
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: 8px;
  color: var(--text-primary);
  padding: 8px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  font-family: inherit;
  min-width: 160px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .sort-select {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.sort-select:hover {
  background: var(--bg-tertiary);
  border-color: var(--border-secondary);
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.dark-mode .sort-select:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.sort-select:focus {
  outline: none;
  border-color: var(--border-accent);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.dark-mode .sort-select:focus {
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
}

.results-count {
  font-size: 13px;
  color: var(--text-muted);
  font-weight: 500;
  transition: color 0.2s ease;
}

.results-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); 
  gap: 24px; 
  max-width: 100%;
}

/* Platform badge colors */
.source-reddit { background: var(--reddit); } 
.source-twitter { background: var(--twitter); }
.source-linkedin { background: var(--linkedin); } 
.source-hackernews { background: var(--hackernews); }
.source-github, .source-medium, .source-tiktok { background: var(--github); color: white; }
.source-stackoverflow { background: var(--stackoverflow); } 
.source-quora { background: var(--quora); }
.source-youtube { background: var(--youtube); } 
.source-producthunt { background: var(--producthunt); }
.source-discord { background: var(--discord); } 
.source-glassdoor { background: var(--glassdoor); }
.source-trustpilot { background: var(--trustpilot); } 
.source-appstore { background: var(--appstore); }
.source-default { background: var(--source-default); }

.result-card { 
  background: var(--bg-card);
  border: 1px solid var(--border-primary);
  border-radius: 12px;
  transition: all 0.15s ease;
  display: flex; 
  flex-direction: column; 
  height: 100%;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .result-card {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.result-card:hover { 
  border-color: var(--border-secondary);
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.dark-mode .result-card:hover {
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
}

.card-header { 
  padding: 24px 24px 20px; 
  border-bottom: 1px solid var(--border-primary);
  position: relative;
  transition: border-color 0.2s ease;
}

.source-info {
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
  margin-bottom: 16px;
  width: 100%;
}

.source-left {
  display: flex;
  flex-direction: column;
  gap: 6px;
  align-items: flex-start;
}

.source-badge { 
  font-size: 10px; 
  font-weight: 700; 
  padding: 4px 8px; 
  border-radius: 6px; 
  text-transform: uppercase; 
  letter-spacing: 0.05em; 
  color: white;
}

.source-date {
  font-size: 10px;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--bg-tertiary);
  padding: 2px 6px;
  border-radius: 4px;
  letter-spacing: 0.02em;
  white-space: nowrap;
  width: fit-content;
  transition: all 0.2s ease;
}

.grumpy-meter-corner {
  position: absolute;
  top: 24px;
  right: 24px;
  z-index: 10;
}

.grumpy-emojis {
  font-size: 20px;
  line-height: 1;
}

.problem-title { 
  font-size: 11px; 
  font-weight: 600; 
  color: var(--text-accent);
  text-transform: uppercase; 
  letter-spacing: 0.05em; 
  margin-bottom: 8px;
  transition: color 0.2s ease;
}

.problem-text { 
  font-size: 15px; 
  line-height: 1.5; 
  color: var(--text-primary); 
  font-style: italic;
  transition: color 0.2s ease;
}

mark {
  background: rgba(37, 99, 235, 0.1);
  color: var(--text-primary);
  padding: 2px 4px;
  border-radius: 4px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.dark-mode mark {
  background: rgba(59, 130, 246, 0.2);
}

.card-body { 
  padding: 24px; 
  flex-grow: 1; 
}

.solution-title { 
  font-size: 11px; 
  font-weight: 600; 
  color: var(--text-accent);
  text-transform: uppercase; 
  letter-spacing: 0.05em; 
  margin-bottom: 12px;
  transition: color 0.2s ease;
}

.solution-text { 
  font-size: 14px; 
  line-height: 1.6; 
  color: var(--text-primary);
  transition: color 0.2s ease;
}

/* Business Viability Section Styles */
.opportunity-section {
  padding: 20px 24px;
  margin: 0 24px 20px 24px;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.opportunity-section.viability-questionable {
  background: rgba(239, 68, 68, 0.08);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.opportunity-section.viability-decent {
  background: rgba(245, 158, 11, 0.08);
  border: 1px solid rgba(245, 158, 11, 0.2);
}

.opportunity-section.viability-brilliant {
  background: rgba(16, 185, 129, 0.08);
  border: 1px solid rgba(16, 185, 129, 0.2);
}

.dark-mode .opportunity-section.viability-questionable {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.3);
}

.dark-mode .opportunity-section.viability-decent {
  background: rgba(245, 158, 11, 0.15);
  border: 1px solid rgba(245, 158, 11, 0.3);
}

.dark-mode .opportunity-section.viability-brilliant {
  background: rgba(16, 185, 129, 0.15);
  border: 1px solid rgba(16, 185, 129, 0.3);
}

.opportunity-title {
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

.opportunity-score-badge {
  font-size: 9px;
  font-weight: 700;
  padding: 3px 6px;
  border-radius: 4px;
  color: white;
}

.opportunity-score-badge.viability-questionable {
  background: #EF4444;
}

.opportunity-score-badge.viability-decent {
  background: #F59E0B;
}

.opportunity-score-badge.viability-brilliant {
  background: #10B981;
}

.opportunity-reasoning {
  font-size: 12px;
  line-height: 1.5;
  color: var(--text-secondary);
  font-style: italic;
  transition: color 0.2s ease;
}

.card-action { 
  padding: 20px 24px 28px; 
  display: flex; 
  flex-direction: column; 
  gap: 12px; 
}

.generate-prd-btn { 
  background: var(--bg-button);
  color: white; 
  border: none; 
  padding: 14px 20px; 
  border-radius: 8px; 
  font-size: 13px; 
  font-weight: 600;
  cursor: pointer; 
  transition: all 0.15s ease; 
  font-family: inherit; 
  text-align: center;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .generate-prd-btn {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.generate-prd-btn:hover { 
  transform: translateY(-1px); 
  box-shadow: 0 4px 8px rgba(37, 99, 235, 0.25);
  background: var(--bg-button-hover);
}

.generate-prd-btn:disabled { 
  opacity: 0.6; 
  cursor: not-allowed; 
  transform: none; 
}

.source-link { 
  color: var(--text-muted); 
  text-decoration: none; 
  font-size: 11px; 
  text-align: center;
  padding: 8px; 
  transition: color 0.15s ease; 
}

.source-link:hover { 
  color: var(--text-accent); 
}

.footer { 
  border-top: 1px solid var(--border-primary); 
  padding: 80px 32px 56px; 
  margin-top: 80px; 
  background: var(--bg-secondary);
  transition: all 0.2s ease;
}

.footer-content { 
  max-width: 800px; 
  margin: 0 auto; 
}

.footer-hero { 
  text-align: center; 
  margin-bottom: 56px; 
}

.footer-hero h2 { 
  font-size: 32px; 
  font-weight: 700; 
  margin-bottom: 16px; 
  color: var(--text-primary);
  letter-spacing: -0.025em;
  transition: color 0.2s ease;
}

.footer-hero p { 
  font-size: 18px; 
  color: var(--text-secondary); 
  max-width: 600px; 
  margin: 0 auto; 
  line-height: 1.6;
  transition: color 0.2s ease;
}

.faqs-section { 
  margin-bottom: 56px; 
}

.faqs-title { 
  font-size: 24px; 
  font-weight: 700; 
  text-align: center; 
  margin-bottom: 32px; 
  color: var(--text-primary);
  letter-spacing: -0.025em;
  transition: color 0.2s ease;
}

.faq-item { 
  background: var(--bg-card); 
  border: 1px solid var(--border-primary); 
  border-radius: 8px;
  margin-bottom: 8px; 
  overflow: hidden; 
  transition: all 0.15s ease;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .faq-item {
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.faq-item:hover { 
  border-color: var(--border-secondary);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.dark-mode .faq-item:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.faq-question { 
  width: 100%; 
  background: none; 
  border: none; 
  padding: 20px 24px; 
  text-align: left;
  color: var(--text-primary); 
  font-size: 15px; 
  font-weight: 500; 
  cursor: pointer; 
  display: flex;
  justify-content: space-between; 
  align-items: center; 
  transition: all 0.15s ease; 
  font-family: inherit; 
}

.faq-question:hover { 
  background: var(--bg-tertiary); 
}

.faq-arrow { 
  transition: transform 0.2s ease; 
  color: var(--text-muted); 
  font-size: 12px; 
}

.faq-question.active .faq-arrow { 
  transform: rotate(180deg); 
  color: var(--text-accent); 
}

.faq-answer { 
  max-height: 0; 
  overflow: hidden; 
  transition: all 0.2s ease; 
  background: var(--bg-tertiary); 
}

.faq-answer.active { 
  max-height: 200px; 
  padding: 20px 24px; 
}

.faq-answer p { 
  color: var(--text-secondary); 
  font-size: 14px; 
  line-height: 1.6; 
  margin: 0;
  transition: color 0.2s ease;
}

.footer-bottom { 
  text-align: center; 
  padding-top: 32px; 
  border-top: 1px solid var(--border-primary); 
}

.footer-bottom p { 
 color: var(--text-muted); 
 font-size: 13px; 
 margin: 0;
 transition: color 0.2s ease;
}

.loading-container, .empty-state { 
 grid-column: 1 / -1; 
 text-align: center; 
 padding: 80px 32px; 
}

.loading-spinner { 
 display: inline-block; 
 width: 32px; 
 height: 32px; 
 border: 2px solid var(--border-primary);
 border-top: 2px solid var(--text-accent); 
 border-radius: 50%; 
 animation: spin 1s linear infinite; 
 margin-bottom: 20px; 
}

@keyframes spin { 
 0% { transform: rotate(0deg); } 
 100% { transform: rotate(360deg); } 
}

.loading-text { 
 color: var(--text-secondary); 
 font-size: 16px;
 transition: color 0.2s ease;
}

.empty-state h3 { 
 color: var(--text-primary); 
 font-size: 20px; 
 font-weight: 600; 
 margin-bottom: 12px;
 transition: color 0.2s ease;
}

.empty-state p { 
 color: var(--text-secondary); 
 font-size: 16px;
 transition: color 0.2s ease;
}

.download-container { 
 margin-top: 56px; 
 display: none; 
}

.download-section { 
 background: var(--bg-card); 
 border: 1px solid var(--border-primary); 
 border-radius: 12px;
 padding: 40px; 
 text-align: center;
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
 transition: all 0.2s ease;
}

.dark-mode .download-section {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.download-title { 
 font-size: 24px; 
 font-weight: 700; 
 color: var(--text-primary); 
 margin-bottom: 12px;
 letter-spacing: -0.025em;
 transition: color 0.2s ease;
}

.download-subtitle { 
 color: var(--text-secondary); 
 font-size: 16px; 
 margin-bottom: 32px;
 transition: color 0.2s ease;
}

.download-btn { 
 background: var(--bg-success); 
 color: white;
 border: none; 
 padding: 16px 32px; 
 border-radius: 8px; 
 font-size: 15px; 
 font-weight: 600; 
 cursor: pointer;
 transition: all 0.15s ease; 
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .download-btn {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.download-btn:hover { 
 transform: translateY(-1px); 
 box-shadow: 0 4px 8px rgba(16, 185, 129, 0.25); 
}

.prd-container { 
 margin-top: 56px; 
 background: var(--bg-card); 
 border: 1px solid var(--border-primary);
 border-radius: 12px; 
 display: none; 
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06); 
 overflow: hidden;
 animation: fadeInUp 0.3s ease-out;
 transition: all 0.2s ease;
}

.dark-mode .prd-container {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

@keyframes fadeInUp { 
 from { opacity: 0; transform: translateY(16px); } 
 to { opacity: 1; transform: translateY(0); } 
}

.prd-header { 
 display: flex; 
 justify-content: space-between; 
 align-items: center; 
 padding: 32px 40px;
 border-bottom: 1px solid var(--border-primary); 
 background: var(--bg-secondary);
 transition: all 0.2s ease;
}

.prd-title { 
 font-size: 24px; 
 font-weight: 700; 
 color: var(--text-primary); 
 margin: 0;
 letter-spacing: -0.025em;
 transition: color 0.2s ease;
}

.prd-actions { 
 display: flex; 
 gap: 12px; 
}

.prd-action-btn { 
 padding: 10px 18px; 
 background: var(--bg-button); 
 color: white; 
 border: none;
 border-radius: 6px; 
 font-size: 13px; 
 font-weight: 500; 
 cursor: pointer; 
 transition: all 0.15s ease;
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .prd-action-btn {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.prd-action-btn:hover { 
 background: var(--bg-button-hover); 
 transform: translateY(-1px);
 box-shadow: 0 2px 4px rgba(37, 99, 235, 0.25);
}

.prd-action-btn.secondary { 
 background: var(--bg-secondary); 
 border: 1px solid var(--border-primary); 
 color: var(--text-primary); 
}

.prd-action-btn.secondary:hover { 
 background: var(--bg-tertiary); 
 border-color: var(--border-secondary); 
}

.prd-content { 
 color: var(--text-primary); 
 line-height: 1.7; 
 padding: 40px; 
 font-size: 15px;
 transition: color 0.2s ease;
}

.prd-content h1 { 
 font-size: 28px; 
 font-weight: 700; 
 margin: 32px 0 20px 0; 
 padding-bottom: 12px;
 border-bottom: 1px solid var(--border-primary);
 letter-spacing: -0.025em;
 transition: border-color 0.2s ease;
}

.prd-content h1:first-child { 
 margin-top: 0; 
}

.prd-content h2 { 
 font-size: 20px; 
 font-weight: 600; 
 margin: 32px 0 16px 0;
 letter-spacing: -0.025em;
}

.prd-content h3 { 
 font-size: 16px; 
 font-weight: 600; 
 margin: 24px 0 12px 0; 
}

.prd-content ul, .prd-content ol { 
 margin: 20px 0; 
 padding-left: 24px; 
}

.prd-content li { 
 margin-bottom: 8px; 
 line-height: 1.7; 
}

.prd-content p { 
 margin: 16px 0; 
 line-height: 1.7; 
}

.prd-content strong { 
 font-weight: 600; 
}

.prd-loading { 
 text-align: center; 
 padding: 80px 40px; 
}

.prd-loading-spinner { 
 display: inline-block; 
 width: 24px; 
 height: 24px; 
 border: 2px solid var(--border-primary);
 border-top: 2px solid var(--text-accent); 
 border-radius: 50%; 
 animation: spin 1s linear infinite; 
 margin-bottom: 24px; 
}

.prd-loading-text { 
 color: var(--text-primary); 
 font-size: 16px; 
 font-weight: 500; 
 margin-bottom: 16px;
 transition: color 0.2s ease;
}

.prd-progress { 
 margin-top: 24px; 
 max-width: 300px; 
 margin-left: auto; 
 margin-right: auto; 
}

.prd-progress-bar { 
 width: 100%; 
 height: 4px; 
 background: var(--bg-tertiary); 
 border-radius: 2px; 
 overflow: hidden;
 transition: background-color 0.2s ease;
}

.prd-progress-fill { 
 height: 100%; 
 background: var(--text-accent); 
 border-radius: 2px; 
 transition: width 0.3s ease; 
 width: 0%; 
}

.prd-source-section { 
 background: var(--bg-tertiary); 
 border-radius: 8px; 
 padding: 24px; 
 margin-top: 32px;
 border: 1px solid var(--border-primary);
 transition: all 0.2s ease;
}

.source-item { 
 margin-bottom: 20px; 
}

.source-item:last-child { 
 margin-bottom: 0; 
}

.source-label { 
 font-weight: 600; 
 color: var(--text-primary); 
 font-size: 14px; 
 margin-bottom: 8px;
 transition: color 0.2s ease;
}

.source-text { 
 color: var(--text-secondary); 
 font-style: italic; 
 line-height: 1.6; 
 font-size: 14px;
 transition: color 0.2s ease;
}

/* MVP Prompt Container Styles */
.mvp-prompt-container {
 background: var(--bg-card);
 border: 1px solid var(--border-primary);
 border-radius: 12px;
 margin: 32px 0;
 overflow: hidden;
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
 transition: all 0.2s ease;
}

.dark-mode .mvp-prompt-container {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.mvp-prompt-header {
 background: var(--bg-tertiary);
 border-bottom: 1px solid var(--border-primary);
 padding: 20px 24px;
 display: flex;
 justify-content: space-between;
 align-items: center;
 transition: all 0.2s ease;
}

.mvp-prompt-title {
 font-size: 16px;
 font-weight: 600;
 color: var(--text-primary);
 margin: 0;
 display: flex;
 align-items: center;
 gap: 8px;
 transition: color 0.2s ease;
}

.mvp-prompt-title::before {
 content: "‚ö°";
 font-size: 18px;
}

.mvp-prompt-actions {
 display: flex;
 gap: 8px;
}

.mvp-copy-btn {
 background: var(--bg-button);
 color: white;
 border: none;
 padding: 8px 16px;
 border-radius: 6px;
 font-size: 12px;
 font-weight: 500;
 cursor: pointer;
 transition: all 0.15s ease;
 display: flex;
 align-items: center;
 gap: 6px;
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

.dark-mode .mvp-copy-btn {
 box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.mvp-copy-btn:hover {
 background: var(--bg-button-hover);
 transform: translateY(-1px);
 box-shadow: 0 2px 4px rgba(37, 99, 235, 0.25);
}

.mvp-copy-btn::before {
 content: "üìã";
 font-size: 12px;
}

.mvp-copy-btn.copied {
 background: var(--bg-success);
}

.mvp-copy-btn.copied::before {
 content: "‚úÖ";
}

.mvp-prompt-content {
 padding: 0;
 position: relative;
}

.mvp-prompt-code {
 background: var(--bg-tertiary);
 color: var(--text-primary);
 padding: 24px;
 margin: 0;
 font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
 font-size: 13px;
 line-height: 1.6;
 overflow-x: auto;
 white-space: pre-wrap;
 word-break: break-word;
 border: none;
 max-height: 400px;
 overflow-y: auto;
 transition: all 0.2s ease;
}

.mvp-prompt-code::-webkit-scrollbar {
 width: 8px;
 height: 8px;
}

.mvp-prompt-code::-webkit-scrollbar-thumb {
 background: var(--border-secondary);
 border-radius: 4px;
}

.mvp-prompt-code::-webkit-scrollbar-track {
 background: transparent;
}

.mvp-prompt-toggle {
 background: none;
 border: none;
 color: var(--text-accent);
 font-size: 12px;
 font-weight: 500;
 cursor: pointer;
 transition: color 0.15s ease;
 display: flex;
 align-items: center;
 gap: 4px;
}

.mvp-prompt-toggle:hover {
 color: var(--text-primary);
}

.mvp-prompt-toggle::after {
 content: "‚ñº";
 font-size: 10px;
 transition: transform 0.2s ease;
}

.mvp-prompt-toggle.collapsed::after {
 transform: rotate(-90deg);
}

.mvp-prompt-content.collapsed .mvp-prompt-code {
 max-height: 100px;
 overflow: hidden;
}

.mvp-prompt-content.collapsed::after {
 content: "";
 position: absolute;
 bottom: 0;
 left: 0;
 right: 0;
 height: 40px;
 background: linear-gradient(transparent, var(--bg-tertiary));
 pointer-events: none;
}

/* Responsive Design */
@media (max-width: 1200px) { 
 .results-grid { 
   grid-template-columns: repeat(2, 1fr); 
 } 
}

@media (max-width: 1024px) { 
 .app { 
   flex-direction: column; 
 }
 
 .sidebar { 
   width: 100%; 
   border-right: none; 
   border-bottom: 1px solid var(--border-primary); 
 }
 
 .results-grid { 
   grid-template-columns: 1fr; 
 }
 
 .controls-row {
   flex-direction: column;
   align-items: stretch;
   gap: 20px;
 }
 
 .filter-group, .sort-group {
   justify-content: center;
 }
 
 .main-content {
   padding: 32px 24px;
 }

 .dark-mode-toggle {
   top: 16px;
   right: 16px;
 }
}

@media (max-width: 768px) {
 .sidebar, .main-content { 
   padding: 24px 16px; 
 }
 
 .search-input, .select-input { 
   font-size: 16px; 
 }
 
 .prd-header { 
   flex-direction: column; 
   gap: 16px; 
   padding: 24px 20px; 
 }
 
 .prd-content { 
   padding: 24px 20px; 
   font-size: 14px; 
 }
 
 .results-title {
   font-size: 36px;
 }
 
 .results-subtitle {
   font-size: 16px;
 }
 
 .footer-hero h2 {
   font-size: 28px;
 }
 
 .filter-group {
   flex-wrap: wrap;
   justify-content: center;
 }
 
 .controls-row {
   text-align: center;
 }
 
 .mvp-prompt-header {
   flex-direction: column;
   gap: 12px;
   align-items: flex-start;
 }
 
 .mvp-prompt-actions {
   width: 100%;
   justify-content: flex-end;
 }
 
 .mvp-prompt-code {
   font-size: 12px;
   padding: 16px;
 }

 .dark-mode-toggle {
   top: 12px;
   right: 12px;
   padding: 6px;
   font-size: 11px;
 }

 .dark-mode-toggle::before {
   font-size: 14px;
 }
}

@media (prefers-reduced-motion: reduce) {
 * { 
   transition: none !important; 
   animation: none !important; 
 }
}

/* Focus states for accessibility */
.search-button:focus-visible,
.filter-btn:focus-visible,
.generate-prd-btn:focus-visible,
.download-btn:focus-visible,
.dark-mode-toggle:focus-visible {
 outline: 2px solid var(--text-accent);
 outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
 :root {
   --border-primary: #000000;
   --text-secondary: #000000;
 }
 
 .dark-mode {
   --border-primary: #FFFFFF;
   --text-secondary: #FFFFFF;
 }
}

/* Smooth transitions for color scheme changes */
* {
 transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
}

/* Ensure dark mode toggle stays on top */
.dark-mode-toggle {
 backdrop-filter: blur(8px);
}

/* Dark mode specific adjustments for better contrast */
.dark-mode .search-input::placeholder,
.dark-mode .select-input::placeholder {
 color: var(--text-muted);
 opacity: 0.8;
}

.dark-mode .mvp-prompt-content.collapsed::after {
 background: linear-gradient(transparent, var(--bg-tertiary));
}
</style>
</head>
<body>

<div class="app">
  <aside class="sidebar">
  <a href="#" class="logo">
    <span class="logo-emoji">üò†</span>
    <span class="logo-text">GrumpyLinks</span>
  </a>
<p class="logo-rant">Fresh Startup Ideas from Grumpy Customers</p>
<p class="logo-subtitle">
Search any topic for user complaints across Reddit, Facebook, Insta, X, YouTube... 
</p>

  <div class="search-section">
    <input id="searchInput" class="search-input" type="text" placeholder="Type a company, service, product‚Ä¶" />
    <select id="queryDropdown" class="select-input">
      <option value="">General Pain Points</option>
      <option value="rage_mode">üî• Full Rage Mode</option>
      <option value="billing_fury">üí∏ Billing Nightmares</option>
      <option value="service_apocalypse">‚ò†Ô∏è Service Disasters</option>
      <option value="feature_betrayal">üíî Missing Features</option>
      <option value="competition_envy">üèÉ Ready to Switch</option>
      <option value="workflow_breakdown">‚öôÔ∏è Process Hell</option>
      <option value="support_abandonment">üÜò Support Failures</option>
    </select>
    <select id="platformSelect" class="select-input">
      <option value="all">All Platforms</option>
      <option value="reddit">Reddit</option>
      <option value="twitter">Twitter</option>
      <option value="linkedin">LinkedIn</option>
      <option value="hackernews">Hacker News</option>
      <option value="youtube">YouTube</option>
      <option value="medium">Medium</option>
      <option value="producthunt">Product Hunt</option>
      <option value="discord">Discord</option>
      <option value="glassdoor">Glassdoor</option>
      <option value="trustpilot">Trustpilot</option>
      <option value="appstore">App Stores</option>
      <option value="forums">Forums</option>
    </select>
    <select id="timeSelect" class="select-input">
      <option value="d7">Last 7 days</option>
      <option value="d1">Last 24 hours</option>
      <option value="d30">Last 30 days</option>
      <option value="d365">Last year</option>
    </select>
    <button id="searchBtn" class="search-button">Search</button>
  </div>
</aside>

  <main class="main-content">
    <div class="results-header" id="resultsHeader" style="display: none;">
      <h2 class="results-title">See who's grumpy about something. üëÄ</h2>
      <p class="results-subtitle">See what people are grumpy about and build a product to delight them.</p>
    </div>

    <!-- Smart Filters and Sorting Controls -->
    <div class="results-controls" id="resultsControls">
      <div class="controls-row">
        <div class="filter-group">
          <span class="filter-label">Filter:</span>
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="hot">üî• Hot Only</button>
          <button class="filter-btn" data-filter="recent">‚ö° Recent</button>
        </div>
        
        <div class="sort-group">
          <span class="filter-label">Sort:</span>
          <select class="sort-select" id="sortSelect">
            <option value="relevance">Sort by Relevance</option>
            <option value="opportunity">Sort by Opportunity</option>
            <option value="frustration">Sort by Frustration Level</option>
          </select>
        </div>
        
        <div class="results-count" id="resultsCount">
          Showing 0 results
        </div>
      </div>
    </div>

    <div id="resultsGrid" class="results-grid">
      <div class="loading-container">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading demo search results...</p>
      </div>
    </div>

<footer class="footer">
  <div class="footer-content">

    <div class="footer-hero">
      <h2>"Complaints are gifts." ~ Jeff B.</h2>
      <p>Ideas built in a vacuum die. GrumpyLinks starts where the world is already complaining and hands you the fastest path from rant to revenue.</p>
    </div>

    <div class="faqs-section">
      <h3 class="faqs-title">FAQs (a.k.a. The Grumpy Gospel)</h3>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          Why not just build my idea and see if people like it?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Because that's how most side hustles crash and burn. Building blind = months wasted on something nobody asked for. 
          We start with real customer pain, so instead of rolling dice you're solving problems people already want fixed.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          Where does GrumpyLinks get its complaints from?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>We use powerful queries, Google's Custom Search Engine, and Gemini AI to mine gripes across 12+ platforms: Reddit, Twitter/X, YouTube, Instagram, Facebook, Discord, and more. 
          If customers are grumpy online, we'll find it‚Äîand hand it to you on a platter.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          Who is GrumpyLinks for?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Dreaming of quitting your 9‚Äî5? This is your shortcut.  
          A content creator? Endless material.  
          A Fortune 500 Marketing VP? Cheap GTM validation before you burn through millions.  
          Basically: anyone who'd rather hear the truth from customers than pay McKinsey $5M for a 100-page deck.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          Isn't this just market research?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Not even close. Traditional research = surveys nobody fills out and interviews where people lie to be polite.  
          We surface what they're already shouting about. It's faster, cheaper, and honestly more fun. 
          Our version comes with launch-ready plans instead of slide decks.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          What do I actually get out of it?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Type in a company, brand, product, or service. We deliver the rants plus an AI-generated plan: problem definition, target users, must-have features, GTM ideas, success metrics, and risks. 
          In short: a launch roadmap you can build, pitch, or create content from‚Äîtoday, not six months from now.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFAQ(this)">
          Why should I trust this more than my gut?
          <span class="faq-arrow">‚ñº</span>
        </button>
        <div class="faq-answer">
          <p>Your gut is biased. Customers aren't. They rant because they're fed up‚Äîand frustration is the raw material of opportunity. 
          The fastest way to win? Fix what's broken. GrumpyLinks just makes sure you hear the signal above the noise.</p>
        </div>
      </div>
    </div>

    <div class="footer-hero">
      <h2>Ready to escape your 9 to 5? Get üò† Grumpy.</h2>
      <p>Join solopreneurs, side hustlers, and creators who know the secret: success isn't about guessing, it's about solving. GrumpyLinks makes it obvious what to build next.</p>
      <p>¬© 2025 GrumpyLinks</p>
    </div>

  </div>
</footer>

  </main>
</div>
<script>
// Configuration
const API_CONFIG = { GOOGLE_API_KEY: '', SEARCH_ENGINE_ID: '', LAMBDA_ENDPOINT: '' };

// Enhanced Power Queries that find REAL complaints and frustrations
const POWER_QUERIES = {
  // Extreme frustration and rage
  rage_mode: { 
    template: '"${keyword}" AND ("absolutely hate" OR "fucking terrible" OR "complete garbage" OR "total disaster" OR "worst ever" OR "never again" OR "avoid at all costs" OR "biggest mistake" OR "waste of money" OR "scam" OR "ripoff" OR "criminal" OR "lawsuit" OR "report them" OR "BBB complaint")'
  },
  
  // Billing and pricing nightmares
  billing_fury: { 
    template: '"${keyword}" AND ("billing" OR "charges" OR "fees" OR "price" OR "cost") AND ("nightmare" OR "scam" OR "surprise" OR "hidden" OR "overcharged" OR "unauthorized" OR "dispute" OR "refund" OR "cancel" OR "fraud" OR "expensive" OR "ridiculous")'
  },
  
  // Service disasters and failures
  service_apocalypse: { 
    template: '"${keyword}" AND ("service" OR "support" OR "help") AND ("terrible" OR "awful" OR "worst" OR "useless" OR "incompetent" OR "rude" OR "unhelpful" OR "ignored" OR "hours on hold" OR "never responded" OR "gave up" OR "nightmare")'
  },
  
  // Missing features that people desperately want
  feature_betrayal: { 
    template: '"${keyword}" AND ("missing" OR "lacks" OR "doesn\'t have" OR "why no" OR "still no" OR "when will" OR "basic feature" OR "simple request" OR "obvious" OR "competitors have" OR "should be standard")'
  },
  
  // Ready to switch to competitors
  competition_envy: { 
    template: '"${keyword}" AND ("switching to" OR "moving to" OR "trying" OR "considering" OR "better than" OR "alternative" OR "replacement" OR "competitor" OR "leaving" OR "done with" OR "fed up")'
  },
  
  // Workflow and process breakdowns
  workflow_breakdown: { 
    template: '"${keyword}" AND ("workflow" OR "process" OR "integration") AND ("broken" OR "nightmare" OR "inefficient" OR "takes forever" OR "manual" OR "workaround" OR "hack" OR "impossible" OR "frustrating")'
  },
  
  // Support abandonment and failures
  support_abandonment: { 
    template: '"${keyword}" AND ("support" OR "help" OR "ticket" OR "chat" OR "call") AND ("never responded" OR "ignored" OR "useless" OR "terrible" OR "gave up" OR "hours waiting" OR "no help" OR "waste of time")'
  }
};

// Platform configurations
const PLATFORMS = {
  all: { sites: [] }, reddit: { sites: ['site:reddit.com'] }, twitter: { sites: ['site:twitter.com', 'site:x.com'] },
  linkedin: { sites: ['site:linkedin.com'] }, hackernews: { sites: ['site:news.ycombinator.com'] },
  youtube: { sites: ['site:youtube.com'] }, medium: { sites: ['site:medium.com'] },
  producthunt: { sites: ['site:producthunt.com'] }, discord: { sites: ['site:discord.com'] },
  glassdoor: { sites: ['site:glassdoor.com'] }, trustpilot: { sites: ['site:trustpilot.com'] },
  appstore: { sites: ['site:apps.apple.com', 'site:play.google.com'] },
  forums: { sites: ['site:stackoverflow.com', 'site:quora.com'] }
};

// Global variables
let currentAnalysis = null;
let currentSearchResults = [];
let allResults = []; // Store all results for filtering
let currentFilter = 'all';
let currentSort = 'relevance';

const DEMO_RESULTS = {
  query: "",
  results: [
    {
      title: "Why is the new AWS UI so freaking bad? : r/aws",
      snippet: "AWS GUIs have always been horrible. Then you use GCP and Azure and realize... Why is this OS so awful? 5 comments. AWS official support quality...",
      link: "https://www.reddit.com/r/aws/comments/1mo6uf7/why_is_the_new_aws_ui_so_freaking_bad/",
      displayLink: "reddit.com",
      insight: { 
        businessOpportunity: "Create a simplified, customizable dashboard that overlays the AWS UI, offering a more intuitive and user-friendly experience. This could involve a browser extension or a standalone application that allows users to create personalized workflows and access frequently used services more easily.", 
        grumpyMeter: 3,
        viability: 2,
        viabilityReasoning: "The AWS UI is consistently criticized for being complex and difficult to navigate. While a complete overhaul is unlikely, a user-friendly overlay could attract users seeking a better experience, however, AWS could change the UI at any time."
      }
    },
    {
      title: "WHY IS AWS NEWS SCREAMING AT ME??? : r/aws",
      snippet: "Freaking horrible, they rolled it back once already, now its second try... The AWS console is PATHETIC for a company of this scale. 48 comments. Is AWS...",
      link: "https://www.reddit.com/r/aws/comments/1meivvy/why_is_aws_news_screaming_at_me/",
      displayLink: "reddit.com",
      insight: { 
        businessOpportunity: "Offer a service that filters and prioritizes AWS news and updates based on user-defined criteria, delivering only relevant information in a concise format. This could be a personalized newsletter, a Slack integration, or a dedicated dashboard that helps users stay informed without being overwhelmed.", 
        grumpyMeter: 3,
        viability: 2,
        viabilityReasoning: "The constant stream of AWS announcements can be overwhelming. A curated news service could save users time and effort, but requires ongoing maintenance to ensure accuracy and relevance. The challenge is to provide sufficient value to justify a paid subscription."
      }
    },
    {
      title: "AWS Lambda cost nightmare: Vercel claims it found a way out ‚Ä¢ The Register",
      snippet: "Vercel claims it's slashed AWS Lambda costs by up to 95 percent by reusing idle instances that would otherwise rack up charges while waiting on slow...",
      link: "https://www.theregister.com/2025/07/31/aws_lambda_cost_nightmare/",
      displayLink: "theregister.com",
      insight: { 
        businessOpportunity: "Develop a cost optimization tool specifically for AWS Lambda, focusing on techniques like instance reuse and right-sizing of function resources. This tool would analyze Lambda usage patterns and provide recommendations for reducing costs without sacrificing performance.", 
        grumpyMeter: 3,
        viability: 3,
        viabilityReasoning: "Lambda costs can quickly spiral out of control, making cost optimization a top priority for many users. A specialized tool that automates this process can generate significant savings and attract a wide customer base."
      }
    },
    {
      title: "How I Cut Lambda Cold Starts in Half Without Changing My Code",
      snippet: "Intermittent slowness is a nightmare to debug ‚Äî there's no consistent trigger, no logs screaming failure. New AWS, Cloud, and DevOps content every day.",
      link: "https://aws.plainenglish.io/how-i-cut-lambda-cold-starts-in-half-without-changing-my-code-b002f58034d0",
      displayLink: "aws.plainenglish.io",
      insight: { 
        businessOpportunity: "Develop a managed service or tool that automatically optimizes AWS Lambda functions to minimize cold starts. This service would analyze function performance and apply techniques like provisioned concurrency or optimized code packaging, reducing latency without requiring code changes from users.", 
        grumpyMeter: 2,
        viability: 3,
        viabilityReasoning: "Lambda cold starts are a persistent pain point, and a solution that reduces them automatically is highly valuable. The technical challenge is significant, but the potential market is large and willing to pay for performance improvements."
      }
    },
    {
      title: "How to Choose the Right Tech Stack for Multi-Team Projects | by Md",
      snippet: "Then there's the integration nightmare. Different teams working in different... New AWS, Cloud, and DevOps content every day. Follow to join our 3.5M+...",
      link: "https://aws.plainenglish.io/how-to-choose-the-right-tech-stack-for-multi-team-projects-6324582a80a6",
      displayLink: "aws.plainenglish.io",
      insight: { 
        businessOpportunity: "Offer consulting services that specialize in helping organizations select and integrate the right tech stack for multi-team projects on AWS. This would involve assessing project requirements, evaluating different technologies, and providing guidance on best practices for collaboration and integration.", 
        grumpyMeter: 2,
        viability: 3,
        viabilityReasoning: "Integration challenges are a common problem in multi-team projects. Expert consulting can significantly improve project outcomes and reduce risks, making it a valuable service for larger organizations."
      }
    },
    {
      title: "Max Rozen on X: \"having fun ETLing my big ass uptime_results...\"",
      snippet: "having fun ETLing my big ass uptime_results table out of AWS RDS into Clickhouse via my laptop would be a nightmare on Australian Internet, thankfully we've...",
      link: "https://x.com/RozenMD/status/1957717641528856630",
      displayLink: "x.com",
      insight: { 
        businessOpportunity: "Provide a simplified ETL (Extract, Transform, Load) service for moving data from AWS RDS to other data warehouses like Clickhouse, with a focus on handling large datasets efficiently. This could involve a cloud-based ETL pipeline or a desktop application that automates the data transfer process.", 
        grumpyMeter: 2,
        viability: 2,
        viabilityReasoning: "Moving large datasets between AWS services can be complex and time-consuming. A simplified ETL service could save users significant effort, but requires expertise in data warehousing and cloud infrastructure. Pre-built connectors and automated scaling are key differentiators."
      }
    }
  ]
};
function loadConfig() {
  if (window.ENV) {
    API_CONFIG.GOOGLE_API_KEY = window.ENV.GOOGLE_API_KEY || '';
    API_CONFIG.SEARCH_ENGINE_ID = window.ENV.SEARCH_ENGINE_ID || '';
    API_CONFIG.LAMBDA_ENDPOINT = window.ENV.LAMBDA_ENDPOINT || '';
  }
}

function toggleFAQ(element) {
  const answer = element.nextElementSibling;
  const isActive = element.classList.contains('active');
  
  document.querySelectorAll('.faq-question').forEach(q => {
    q.classList.remove('active');
    q.nextElementSibling.classList.remove('active');
  });
  
  if (!isActive) {
    element.classList.add('active');
    answer.classList.add('active');
  }
}

function setupEventListeners() {
  document.getElementById('searchBtn').onclick = performSearch;
  document.getElementById('searchInput').onkeydown = e => {
    if (e.key === 'Enter') performSearch();
  };
  document.getElementById('searchInput').oninput = e => {
    localStorage.setItem('grumpy_search', e.target.value);
  };
  
  // Filter button listeners
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const filter = e.target.dataset.filter;
      setActiveFilter(filter);
      applyFiltersAndSort();
    });
  });
  
  // Sort listener
  document.getElementById('sortSelect').addEventListener('change', (e) => {
    currentSort = e.target.value;
    applyFiltersAndSort();
  });
}

function setActiveFilter(filter) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.filter === filter) {
      btn.classList.add('active');
    }
  });
}

function applyFiltersAndSort() {
  let filteredResults = [...allResults];
  
  // Apply filters
  switch(currentFilter) {
    case 'hot':
      filteredResults = filteredResults.filter(result => result.viability === 3);
      break;
    case 'recent':
      // Since we don't have dates, we'll use the first 50% as "recent"
      filteredResults = filteredResults.slice(0, Math.ceil(filteredResults.length / 2));
      break;
    case 'all':
    default:
      // No filtering needed
      break;
  }
  
  // Apply sorting
  switch(currentSort) {
    case 'opportunity':
      filteredResults.sort((a, b) => b.viability - a.viability);
      break;
    case 'frustration':
      filteredResults.sort((a, b) => b.grumpyMeter - a.grumpyMeter);
      break;
    case 'relevance':
    default:
      // Keep original order
      break;
  }
  
  // Update results count
  updateResultsCount(filteredResults.length, allResults.length);
  
  // Re-render results
  renderFilteredResults(filteredResults);
}

function updateResultsCount(filtered, total) {
  const countEl = document.getElementById('resultsCount');
  if (filtered === total) {
    countEl.textContent = `Showing ${total} results`;
  } else {
    countEl.textContent = `Showing ${filtered} of ${total} results`;
  }
}

function buildSearchQuery(template, keyword, platform) {
  let query = template.replace(/\$\{keyword\}/g, keyword);
  const platformConfig = PLATFORMS[platform] || PLATFORMS.all;
  if (platformConfig.sites.length > 0) {
    query += ` (${platformConfig.sites.join(' OR ')})`;
  }
  return query;
}

function buildNormalSearchQuery(keyword, platform) {
  let query = `"${keyword}" AND (("absolutely hate" OR "fucking terrible" OR "complete disaster" OR "worst ever" OR "never again" OR "total garbage" OR "waste of money" OR "biggest mistake" OR "scam" OR "ripoff" OR "avoid at all costs") OR ("nightmare" OR "awful" OR "terrible" OR "horrible" OR "disgusting" OR "pathetic" OR "ridiculous" OR "useless" OR "broken" OR "fails" OR "doesn't work") OR ("frustrated" OR "angry" OR "pissed off" OR "fed up" OR "sick of" OR "tired of" OR "done with" OR "can't stand" OR "driving me crazy"))`;
  
  // Essential exclusions only
  query += ` -site:docs.* -site:help.* -site:support.* -"how to" -"tutorial" -"guide" -"help me"`;
  
  const platformConfig = PLATFORMS[platform] || PLATFORMS.all;
  if (platformConfig.sites.length > 0) {
    query += ` (${platformConfig.sites.join(' OR ')})`;
  }
  return query;
}

function getPlatformClass(domain) {
  const platforms = {
    reddit: 'source-reddit', twitter: 'source-twitter', 'x.com': 'source-twitter',
    linkedin: 'source-linkedin', 'news.ycombinator': 'source-hackernews', github: 'source-github',
    stackoverflow: 'source-stackoverflow', medium: 'source-medium', quora: 'source-quora',
    youtube: 'source-youtube', producthunt: 'source-producthunt', discord: 'source-discord',
    glassdoor: 'source-glassdoor', trustpilot: 'source-trustpilot', tiktok: 'source-tiktok',
    'apps.apple.com': 'source-appstore', 'play.google.com': 'source-appstore'
  };
  
  const match = Object.keys(platforms).find(key => domain.includes(key));
  return match ? platforms[match] : 'source-default';
}

function getPlatformName(domain) {
  const platforms = {
    reddit: 'Reddit', twitter: 'Twitter', 'x.com': 'Twitter', linkedin: 'LinkedIn',
    'news.ycombinator': 'Hacker News', github: 'GitHub', stackoverflow: 'Stack Overflow',
    medium: 'Medium', quora: 'Quora', youtube: 'YouTube', producthunt: 'Product Hunt',
    discord: 'Discord', glassdoor: 'Glassdoor', trustpilot: 'Trustpilot', tiktok: 'TikTok',
    'apps.apple.com': 'App Store', 'play.google.com': 'Play Store'
  };
  
  const platformMatch = Object.keys(platforms).find(key => domain.includes(key));
  if (platformMatch) {
    return platforms[platformMatch];
  }
  
  const parts = domain.split('.');
  
  if (parts.length >= 2) {
    if (parts.length >= 3) {
      const subdomain = parts[0];
      const mainDomain = parts[parts.length - 2];
      
      const skipSubdomains = ['www', 'm', 'mobile', 'old', 'new', 'beta', 'staging', 'support', 'help'];
      if (skipSubdomains.includes(subdomain.toLowerCase())) {
        return mainDomain.charAt(0).toUpperCase() + mainDomain.slice(1);
      }
      
      return `${subdomain}.${mainDomain}`;
    } else {
      const mainDomain = parts[0];
      return mainDomain.charAt(0).toUpperCase() + mainDomain.slice(1);
    }
  }
  
  return domain;
}

function findInsightForResult(result, analysis) {
  if (!analysis || !analysis.resultInsights) {
    return {
      businessOpportunity: "AI analysis not available for this result",
      grumpyMeter: 2,
      viability: 2,
      viabilityReasoning: "Business assessment not available"
    };
  }

  if (analysis.resultInsights.length > 0 && !analysis.resultInsights[0].title) {
    const resultIndex = analysis.resultInsights.findIndex((insight, index) => {
      return index < analysis.resultInsights.length;
    });
    
    if (resultIndex >= 0 && analysis.resultInsights[resultIndex]) {
      return analysis.resultInsights[resultIndex];
    }
  }

  const directMatch = analysis.resultInsights.find(insight => {
    return insight.title && insight.title === result.title;
  });
  if (directMatch) {
    return directMatch;
  }

  if (result.title) {
    const resultTitleWords = result.title.toLowerCase().split(' ').slice(0, 5).join(' ');
    const matchingInsight = analysis.resultInsights.find(insight => {
      if (!insight.title) return false;
      const insightTitleWords = insight.title.toLowerCase().split(' ').slice(0, 5).join(' ');
      return resultTitleWords.includes(insightTitleWords.slice(0, 20)) || 
             insightTitleWords.includes(resultTitleWords.slice(0, 20));
    });

    if (matchingInsight) {
      return matchingInsight;
    }
  }

  return analysis.resultInsights[0] || {
    businessOpportunity: "Monitor this result for business opportunities",
    grumpyMeter: 2,
    viability: 2,
    viabilityReasoning: "Business assessment needed"
  };
}

function getViabilityDisplay(level) {
  const levelInt = parseInt(level) || 2;
  
  const displays = {
    1: { label: 'QUESTIONABLE IDEA', class: 'viability-questionable' },
    2: { label: 'DECENT OPPORTUNITY', class: 'viability-decent' },
    3: { label: 'BRILLIANT IDEA', class: 'viability-brilliant' }
  };
  
  return displays[levelInt] || displays[2];
}

function getGrumpyMeterDisplay(level) {
  const levelInt = parseInt(level) || 2;
  
  const displays = {
    1: { emojis: 'üò†', label: 'MILD ANNOYANCE' },
    2: { emojis: 'üò†üò†', label: 'GROWING RAGE' },
    3: { emojis: 'üò†üò†üò†', label: 'FULL MELTDOWN' }
  };
  
  return displays[levelInt] || displays[2];
}

function performGoogleSearch(query, timeRange) {
  if (!API_CONFIG.GOOGLE_API_KEY || !API_CONFIG.SEARCH_ENGINE_ID) {
    throw new Error('Google API not configured');
  }

  const params = new URLSearchParams({
    key: API_CONFIG.GOOGLE_API_KEY,
    cx: API_CONFIG.SEARCH_ENGINE_ID,
    q: query,
    num: '9', 
    dateRestrict: timeRange
  });

  return fetch(`https://www.googleapis.com/customsearch/v1?${params.toString()}`)
    .then(response => {
      if (!response.ok) {
        return response.json().then(error => {
          throw new Error(error.error?.message || 'Search failed');
        });
      }
      return response.json();
    })
    .then(data => {
      return data.items || [];
    });
}

function analyzeWithAI(results, query, platform) {
  if (!API_CONFIG.LAMBDA_ENDPOINT) {
    return Promise.resolve({
      mainPainPoint: "AI analysis not configured",
      resultInsights: [],
      overallOpportunityScore: 3,
      topActionableIdeas: ["Configure Lambda endpoint to enable AI analysis"]
    });
  }

  return fetch(API_CONFIG.LAMBDA_ENDPOINT, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ query, platform, results: results.slice(0, 10) })
  })
  .then(response => {
    if (!response.ok) throw new Error(`AI analysis failed: ${response.status}`);
    return response.json();
  })
  .catch(error => {
    console.error('AI analysis error:', error);
    return {
      mainPainPoint: "AI analysis temporarily unavailable",
      resultInsights: [],
      overallOpportunityScore: 3,
      topActionableIdeas: ["AI analysis error - please try again"]
    };
  });
}

function updateResultsHeader(keyword) {
  const resultsTitle = document.querySelector('.results-title');
  
  if (resultsTitle) {
    if (!keyword || keyword.trim() === '') {
      resultsTitle.textContent = `See who's grumpy about something. üëÄ`;
    } else {
      const capitalizedKeyword = keyword.toUpperCase();
      resultsTitle.textContent = `See who's grumpy about ${capitalizedKeyword}. üëÄ`;
    }
  }
}

function performSearch() {
  const keyword = document.getElementById('searchInput').value.trim();
  if (!keyword) {
    const searchInput = document.getElementById('searchInput');
    searchInput.style.borderColor = 'var(--bg-danger)';
    searchInput.placeholder = 'Please enter a search term...';
    searchInput.focus();
    
    setTimeout(() => {
      searchInput.style.borderColor = '';
      searchInput.placeholder = 'Brand, product, or topic...';
    }, 3000);
    return;
  }

  const queryType = document.getElementById('queryDropdown').value;
  const platform = document.getElementById('platformSelect').value;
  const timeRange = document.getElementById('timeSelect').value;

  updateResultsHeader(keyword);
  showLoading();
  closePrd();

  let query;
  let powerQuery = null;
 
  if (queryType && POWER_QUERIES[queryType]) {
    powerQuery = POWER_QUERIES[queryType];
    query = buildSearchQuery(powerQuery.template, keyword, platform);
  } else {
    query = buildNormalSearchQuery(keyword, platform);
  }
 
  performGoogleSearch(query, timeRange)
    .then(results => {
      if (results.length > 0) {
        return analyzeWithAI(results, query, platform)
          .then(analysis => {
            currentAnalysis = analysis;
            displayResults(results, powerQuery, keyword, analysis);
          });
      } else {
        displayResults(results, powerQuery, keyword, null);
      }
    })
    .catch(error => {
      showError(error.message);
    });
}

function showLoading() {
  const grid = document.getElementById('resultsGrid');
  const resultsHeader = document.getElementById('resultsHeader');
  const resultsControls = document.getElementById('resultsControls');
  const downloadBtn = document.getElementById('downloadOpportunitiesBtn');

  resultsHeader.style.display = 'block';
  resultsControls.style.display = 'none';
  if (downloadBtn) downloadBtn.style.display = 'none';
  grid.innerHTML = `
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">Analyzing pain points across platforms...</p>
    </div>
  `;
}

function showError(message) {
  const grid = document.getElementById('resultsGrid');
  const resultsControls = document.getElementById('resultsControls');
  const downloadBtn = document.getElementById('downloadOpportunitiesBtn');
  resultsControls.style.display = 'none';
  if (downloadBtn) downloadBtn.style.display = 'none';
  grid.innerHTML = `
    <div class="empty-state">
      <h3>Search Error</h3>
      <p>${message}</p>
    </div>
  `;
}

function escapeHtml(text) {
  if (typeof text !== 'string') return text;
  const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
  return text.replace(/[&<>"']/g, m => map[m]);
}

function renderFilteredResults(results) {
  const grid = document.getElementById('resultsGrid');
  
  if (!results.length) {
    grid.innerHTML = `
      <div class="empty-state">
        <h3>No Results Match Your Filters</h3>
        <p>Try adjusting your filters or search terms.</p>
      </div>
    `;
    return;
  }

  const html = results.map((result, i) => {
    const platformClass = getPlatformClass(result.displayLink);
    const platformName = getPlatformName(result.displayLink);
    
    let snippet = result.snippet || '';

    // Enhanced cleaning
    snippet = snippet
      .replace(/&quot;/g, '"')
      .replace(/&amp;/g, '&')
      .replace(/&lt;/g, '<')
      .replace(/&gt;/g, '>')
      .replace(/&#39;/g, "'")
      .replace(/\s*‚Ä¶\s*/g, ' ')
      .replace(/\s+/g, ' ');

    const timePatterns = [
      /\d+\s*(days?|hours?|minutes?|weeks?|months?|years?)\s*ago/gi,
      /\w{3}\s+\d{1,2},?\s+\d{4}/g,
      /\d{1,2}\/\d{1,2}\/\d{4}/g,
      /\d{4}-\d{2}-\d{2}/g,
      /\d{1,2}-\d{1,2}-\d{4}/g,
      /\d{1,2}:\d{2}(\s*[ap]m)?/gi,
      /(yesterday|today|tomorrow)/gi,
      /(monday|tuesday|wednesday|thursday|friday|saturday|sunday)/gi,
      /(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\s+\d{1,2}/gi,
      /\d{1,2}\s+(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*/gi,
      /\bat\s+\d{1,2}:\d{2}/gi,
      /posted\s+\d+/gi,
      /\d+\s*hrs?\s*ago/gi,
      /\d+\s*mins?\s*ago/gi
    ];

    timePatterns.forEach(pattern => {
      snippet = snippet.replace(pattern, '').replace(/\s+/g, ' ').trim();
    });

    const metaPrefixes = [
      /^(posted by|by|from|via|source|update|edit|edited)\s+/gi,
      /^(share|comment|reply|repost|retweet)\s+/gi,
      /^(likes?|upvotes?|views?)\s+\d+\s*/gi,
      /^\d+\s+(likes?|upvotes?|views?)\s*/gi
    ];

    metaPrefixes.forEach(pattern => {
      snippet = snippet.replace(pattern, '').trim();
    });

    snippet = snippet
      .replace(/^[.,\s-¬∑:;]*/, '')
      .replace(/[.,\s-¬∑:;]*$/, '')
      .replace(/\s+/g, ' ')
      .trim();

    const truncatedSnippet = snippet.substring(0, 120);
    const escapedSnippet = escapeHtml(truncatedSnippet);

    const painWords = ['frustrated', 'hate', 'terrible', 'broken', 'annoying', 'wish', 'need', 'help', 'urgent', 'switching', 'alternative', 'missing', 'lack', 'awful', 'sucks', 'nightmare', 'disaster'];
    let highlightedSnippet = escapedSnippet;

    painWords.forEach(word => {
      const regex = new RegExp(`(^|\\s)(${word})(\\s|$)`, 'gi');
      highlightedSnippet = highlightedSnippet.replace(regex, '$1<mark>$2</mark>$3');
    });
    
    const grumpyDisplay = getGrumpyMeterDisplay(result.grumpyMeter);
    const viabilityDisplay = getViabilityDisplay(result.viability);

    return `
      <div class="result-card">
        <div class="card-header">
          <div class="source-info">
            <div class="source-left">
              <span class="source-badge ${platformClass}">${platformName}</span>
            </div>
          </div>
          <div class="grumpy-meter-corner">
            <div class="grumpy-emojis">${grumpyDisplay.emojis}</div>
          </div>
          <div class="problem-statement">
            <h3 class="problem-title">COMPLAINT:</h3>
            <p class="problem-text">"${highlightedSnippet}..."</p>
          </div>
        </div>
        <div class="card-body">
          <h4 class="solution-title">BIG IDEA</h4>
          <p class="solution-text">${result.businessOpportunity || 'Analyzing opportunity...'}</p>
        </div>
        <div class="opportunity-section ${viabilityDisplay.class}">
          <div class="opportunity-title">
            <span class="opportunity-score-badge ${viabilityDisplay.class}">${viabilityDisplay.label}</span>
          </div>
          <div class="opportunity-reasoning">${result.viabilityReasoning || 'Business assessment not available'}</div>
        </div>
        <div class="card-action">
          <button class="generate-prd-btn" 
                  data-title="${escapeHtml(result.title)}" 
                  data-snippet="${escapeHtml(result.snippet || '')}" 
                  data-opportunity="${escapeHtml(result.businessOpportunity || '')}">
            Launch Plan
          </button>
          <a href="${result.link}" target="_blank" class="source-link">View Original Complaint</a>
        </div>
      </div>
    `;
  }).join('');

  grid.innerHTML = html;

  document.querySelectorAll('.generate-prd-btn').forEach(btn => {
    btn.addEventListener('click', e => {
      const { title, snippet, opportunity } = e.target.dataset;
      generatePrdPrompt(title, snippet, opportunity);
    });
  });
}

function displayResults(results, powerQuery, keyword, analysis) {
  const grid = document.getElementById('resultsGrid');
  const resultsHeader = document.getElementById('resultsHeader');
  const resultsControls = document.getElementById('resultsControls');

  resultsHeader.style.display = 'block';
  updateResultsHeader(keyword);

  if (!results.length) {
    resultsControls.style.display = 'none';
    grid.innerHTML = `
      <div class="empty-state">
        <h3>No Pain Points Found</h3>
        <p>Try a different search term, platform, or time range to discover customer complaints.</p>
      </div>
    `;
    currentSearchResults = [];
    allResults = [];
    return;
  }

  currentSearchResults = [];
  allResults = [];
  
  results.forEach((result, i) => {
    let insight;
    if (result.insight) {
      insight = result.insight;
    } else if (analysis) {
      insight = findInsightForResult(result, analysis);
    } else {
      insight = {
        businessOpportunity: "AI analysis not available for this result",
        grumpyMeter: 2,
        viability: 2,
        viabilityReasoning: "Business assessment not available"
      };
    }

    const validLevels = [1, 2, 3];
    if (!validLevels.includes(parseInt(insight.grumpyMeter))) {
      insight.grumpyMeter = 2;
    }
    if (!validLevels.includes(parseInt(insight.viability))) {
      insight.viability = 2;
    }

    const platformName = getPlatformName(result.displayLink);

    const resultData = {
      title: result.title,
      link: result.link,
      snippet: result.snippet,
      displayLink: result.displayLink,
      platform: platformName,
      businessOpportunity: insight.businessOpportunity || 'N/A',
      grumpyMeter: insight.grumpyMeter || 2,
      viability: insight.viability || 2,
      viabilityReasoning: insight.viabilityReasoning || 'Business assessment not available'
    };

    currentSearchResults.push(resultData);
    allResults.push(resultData);
  });

  // Show controls and set initial filter/sort
  resultsControls.style.display = 'block';
  currentFilter = 'all';
  currentSort = 'relevance';
  setActiveFilter('all');
  document.getElementById('sortSelect').value = 'relevance';
  
  // Apply initial filters and sort
  applyFiltersAndSort();
  
  // Update download section
  let downloadContainer = document.getElementById('download-container');
  if (!downloadContainer) {
    downloadContainer = document.createElement('div');
    downloadContainer.id = 'download-container';
    downloadContainer.className = 'download-container';
    grid.parentNode.insertBefore(downloadContainer, grid.nextSibling);
  }
  
  if (currentSearchResults.length > 0) {
    downloadContainer.innerHTML = `
      <div class="download-section">
        <h3 class="download-title">Export Opportunities List</h3>
        <p class="download-subtitle">Download all ${currentSearchResults.length} opportunities as a CSV file for analysis</p>
        <button class="download-btn" onclick="downloadOpportunities()">Download CSV</button>
      </div>
    `;
    downloadContainer.style.display = 'block';
  } else {
    downloadContainer.style.display = 'none';
  }
}

function downloadOpportunities() {
  if (currentSearchResults.length === 0) {
    const btn = event.target;
    const originalText = btn.textContent;
    btn.textContent = '‚ö† No Data';
    btn.style.background = 'var(--bg-danger)';
    
    setTimeout(() => {
      btn.textContent = originalText;
      btn.style.background = '';
    }, 2000);
    return;
  }

  const headers = ["Title", "Link", "Snippet", "Platform", "Business Opportunity", "Grumpy Meter", "Viability", "Viability Reasoning"];
  const fieldMapping = {
    "Title": "title", 
    "Link": "link", 
    "Snippet": "snippet", 
    "Platform": "platform",
    "Business Opportunity": "businessOpportunity", 
    "Grumpy Meter": "grumpyMeter",
    "Viability": "viability",
    "Viability Reasoning": "viabilityReasoning"
  };
  
  const rows = currentSearchResults.map(row => 
    headers.map(header => {
      const fieldValue = row[fieldMapping[header]] || '';
      const stringValue = String(fieldValue);
      const escapedValue = stringValue.replace(/"/g, '""');
      return `"${escapedValue}"`;
    }).join(',')
  );
  
  const dataStr = headers.join(',') + '\n' + rows.join('\n');
  const filename = `grumpylinks_opportunities_${new Date().toISOString().slice(0,10)}.csv`;

  const blob = new Blob([dataStr], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  const btn = event.target;
  const originalText = btn.textContent;
  btn.textContent = '‚úÖ Downloaded!';
  btn.style.background = 'linear-gradient(135deg, #16a34a 0%, #15803d 100%)';
  
  setTimeout(() => {
    btn.textContent = originalText;
    btn.style.background = 'linear-gradient(135deg, var(--bg-success) 0%, #16a34a 100%)';
  }, 2000);
}

// PRD Generation functions (keeping existing functionality)
function generatePrdPrompt(originalTitle, snippet, opportunity) {
  if (!API_CONFIG.LAMBDA_ENDPOINT) {
    showPrdError('Launch plan generation not configured. Please check your settings.');
    return;
  }

  const button = event.target;
  const card = button.closest('.result-card');
  const sourceLink = card?.querySelector('.source-link').href || '#';

  const originalText = button.textContent;
  button.textContent = 'Generating...';
  button.disabled = true;

  showPrdLoading(originalTitle);
  const progressInterval = startProgressAnimation();

  fetch(API_CONFIG.LAMBDA_ENDPOINT, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ 
      action: 'generate_launch_plan',
      originalTitle, snippet, opportunity
    })
  })
  .then(response => {
    if (!response.ok) throw new Error(`Launch plan generation failed: ${response.status}`);
    return response.json();
  })
  .then(data => {
    clearInterval(progressInterval);
    if (data.launchPlan) {
      showPrdResults(data.launchPlan, originalTitle, snippet, opportunity, sourceLink);
    } else {
      throw new Error('No launch plan content received');
    }
  })
  .catch(error => {
    clearInterval(progressInterval);
    console.error('Launch plan generation error:', error);
    showPrdError(error.message);
  })
  .finally(() => {
    button.textContent = originalText;
    button.disabled = false;
  });
}

function showPrdLoading(title) {
  const container = getPrdContainer();
  container.innerHTML = `
    <div class="prd-header">
      <h2 class="prd-title">üöÄ Creating Launch Plan...</h2>
    </div>
    <div class="prd-loading">
      <div class="prd-loading-spinner"></div>
      <div class="prd-loading-text">Creating your launch plan for:<br><strong>"${escapeHtml(title)}"</strong></div>
      <div class="prd-progress">
        <div class="prd-progress-bar">
          <div class="prd-progress-fill" id="prd-progress-fill"></div>
        </div>
      </div>
    </div>
  `;
  container.style.display = 'block';
  container.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function startProgressAnimation() {
  let progress = 0;
  const progressFill = document.getElementById('prd-progress-fill');
  
  return setInterval(() => {
    progress += 20;
    if (progress > 90) progress = 90;
    if (progressFill) progressFill.style.width = `${progress}%`;
  }, 800);
}

function showPrdResults(launchPlanData, originalTitle, snippet, opportunity, sourceLink) {
  const container = getPrdContainer();
  
  // Check if we got structured data or just text
  if (launchPlanData.isText || typeof launchPlanData === 'string') {
    // Handle old text-based response
    const formattedContent = formatPrdContent(typeof launchPlanData === 'string' ? launchPlanData : launchPlanData.toString());
    showTextBasedPrd(container, formattedContent, originalTitle, opportunity, sourceLink);
    return;
  }
  
  // Handle new structured response
  const plan = launchPlanData;
  const productName = plan.productName || "Your Product";
  
  container.innerHTML = `
    <div class="prd-header">
      <h2 class="prd-title">üöÄ ${productName} - Launch Plan</h2>
      <div class="prd-actions">
        <button class="prd-action-btn" onclick="copyFullPlanToClipboard()">Copy Full Plan</button>
        <button class="prd-action-btn secondary" onclick="downloadPrd()">Download</button>
        <button class="prd-action-btn secondary" onclick="closePrd()">‚úï Close</button>
      </div>
    </div>
    
    <div class="prd-content">
      <h2>Overview</h2>
      <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px; margin-bottom: 24px;">
        <p><strong>What You're Building:</strong> ${escapeHtml(plan.strategy?.whatYoureBuilding || 'Strategy not available')}</p>
        <p><strong>Target Customer:</strong> ${escapeHtml(plan.strategy?.targetCustomer || 'Customer analysis not available')}</p>
        <p><strong>Value Proposition:</strong> ${escapeHtml(plan.strategy?.valueProposition || 'Value prop not available')}</p>
        <p><strong>Validation Goal:</strong> ${escapeHtml(plan.strategy?.validationGoal || 'Validation metrics not available')}</p>
      </div>

      ${createMvpPromptContainer(plan.mvpPrompt || 'MVP prompt not available')}

      <h2>Next 48 Hours</h2>
      <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px; margin-bottom: 24px;">
        <p><strong>Day 1:</strong> ${escapeHtml(plan.timeline?.day1 || 'Day 1 plan not available')}</p>
        <p><strong>Day 2:</strong> ${escapeHtml(plan.timeline?.day2 || 'Day 2 plan not available')}</p>
      </div>

      <h2>Success Metrics</h2>
      <div style="background: var(--bg-tertiary); padding: 20px; border-radius: 8px; margin-bottom: 24px;">
        <p><strong>Week 1:</strong> ${escapeHtml(plan.successMetrics?.week1 || 'Week 1 metrics not available')}</p>
        <p><strong>Pivot Signal:</strong> ${escapeHtml(plan.successMetrics?.pivotSignal || 'Pivot criteria not available')}</p>
      </div>

      <h2>Reality Check</h2>
      <div style="background: var(--bg-card); padding: 20px; border-radius: 8px; margin-bottom: 24px;">
        <p style="font-style: italic; color: var(--text-primary);">${escapeHtml(plan.realityCheck || 'Motivational message not available')}</p>
      </div>
      
      <h2>Source</h2>
      <div class="prd-source-section">
        <div class="source-item">
          <div class="source-label">Customer Pain Point:</div>
          <div class="source-text">"${escapeHtml(originalTitle)}"</div>
        </div>
        <div class="source-item">
          <div class="source-label">Business Opportunity:</div>
          <div class="source-text">${escapeHtml(opportunity)}</div>
        </div>
        <div class="source-item">
          <div class="source-label">Original Source:</div>
          <div class="source-text">${escapeHtml(sourceLink)}</div>
        </div>
      </div>
    </div>
  `;

  // Store for copying/downloading
  window.currentPrdContent = generateMarkdownFromStructured(plan, originalTitle, opportunity, sourceLink);
  window.currentMvpPrompt = plan.mvpPrompt || '';

  const progressFill = document.getElementById('prd-progress-fill');
  if (progressFill) {
    progressFill.style.width = '100%';
  }

  container.style.display = 'block';
  setTimeout(() => container.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
}

function createMvpPromptContainer(mvpPrompt) {
  const promptId = 'mvp-prompt-' + Date.now();
  
  return `
    <h2>Landing Page Prompt</h2>
    <div class="mvp-prompt-container">
      <div class="mvp-prompt-header">
        <h3 class="mvp-prompt-title">Paste into your fav AI tool.</h3>
        <div class="mvp-prompt-actions">
          <button class="mvp-prompt-toggle" onclick="toggleMvpPrompt('${promptId}')">Show/Hide</button>
          <button class="mvp-copy-btn" onclick="copyMvpPrompt('${promptId}')">Copy Prompt</button>
        </div>
      </div>
      <div class="mvp-prompt-content" id="${promptId}">
        <pre class="mvp-prompt-code">${escapeHtml(mvpPrompt)}</pre>
      </div>
    </div>
    <p style="margin-top: 16px; color: var(--text-secondary); font-size: 14px;">
      <strong>üí° How to use:</strong> Copy the prompt above and paste it into Claude 4.0 or Gemini 2.5 to generate your landing page.
    </p>
  `;
}

function toggleMvpPrompt(promptId) {
  const content = document.getElementById(promptId);
  const button = event.target;
  
  if (content.classList.contains('collapsed')) {
    content.classList.remove('collapsed');
    button.textContent = 'Show/Hide';
    button.classList.remove('collapsed');
  } else {
    content.classList.add('collapsed');
    button.textContent = 'Show Full';
    button.classList.add('collapsed');
  }
}

function copyMvpPrompt(promptId) {
  const promptElement = document.querySelector(`#${promptId} .mvp-prompt-code`);
  const promptText = promptElement ? promptElement.textContent : window.currentMvpPrompt;
  
  const button = event.target;
  
  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(promptText).then(() => {
      showCopySuccess(button);
    }).catch(() => {
      fallbackCopy(promptText, button);
    });
  } else {
    fallbackCopy(promptText, button);
  }
}

function fallbackCopy(text, button) {
  const textArea = document.createElement('textarea');
  textArea.value = text;
  textArea.style.position = 'fixed';
  textArea.style.left = '-999999px';
  textArea.style.top = '-999999px';
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    const successful = document.execCommand('copy');
    if (successful) {
      showCopySuccess(button);
    } else {
      alert('Could not copy prompt. Please select and copy manually.');
    }
  } catch (err) {
    alert('Could not copy prompt. Please select and copy manually.');
  } finally {
    document.body.removeChild(textArea);
  }
}

function showCopySuccess(button) {
  const originalText = button.textContent;
  const originalClass = button.className;
  
  button.textContent = 'Copied!';
  button.classList.add('copied');
  
  setTimeout(() => {
    button.textContent = originalText;
    button.className = originalClass;
  }, 2000);
}

function copyFullPlanToClipboard() {
  if (!window.currentPrdContent) return;

  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(window.currentPrdContent).then(() => {
      const btn = document.querySelector('.prd-action-btn[onclick="copyFullPlanToClipboard()"]');
      if (btn) {
        const originalText = btn.textContent;
        btn.textContent = '‚úÖ Copied!';
        btn.style.background = 'var(--bg-success)';
        setTimeout(() => {
          btn.textContent = originalText;
		  btn.style.background = 'var(--bg-button)';
        }, 2000);
      }
    }).catch(() => {
      fallbackCopyFullPlan();
    });
  } else {
    fallbackCopyFullPlan();
  }
}

function fallbackCopyFullPlan() {
  const textArea = document.createElement('textarea');
  textArea.value = window.currentPrdContent;
  textArea.style.position = 'fixed';
  textArea.style.left = '-999999px';
  textArea.style.top = '-999999px';
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    const successful = document.execCommand('copy');
    if (successful) {
      const btn = document.querySelector('.prd-action-btn[onclick="copyFullPlanToClipboard()"]');
      if (btn) {
        const originalText = btn.textContent;
        btn.textContent = '‚úÖ Copied!';
        btn.style.background = 'var(--bg-success)';
        setTimeout(() => {
          btn.textContent = originalText;
          btn.style.background = 'var(--bg-button)';
        }, 2000);
      }
    } else {
      alert('Could not copy to clipboard. Please select and copy manually.');
    }
  } catch (err) {
    alert('Could not copy to clipboard. Please select and copy manually.');
  } finally {
    document.body.removeChild(textArea);
  }
}

function generateMarkdownFromStructured(plan, originalTitle, opportunity, sourceLink) {
  return `# ${plan.productName || 'Product'} - Launch Plan

## Product Strategy

**What You're Building:** ${plan.strategy?.whatYoureBuilding || 'Strategy not available'}
**Target Customer:** ${plan.strategy?.targetCustomer || 'Customer analysis not available'}
**Value Proposition:** ${plan.strategy?.valueProposition || 'Value prop not available'}
**Validation Goal:** ${plan.strategy?.validationGoal || 'Validation metrics not available'}

## MVP Implementation

\`\`\`
${plan.mvpPrompt || 'MVP prompt not available'}
\`\`\`

## Next 48 Hours

**Day 1:** ${plan.timeline?.day1 || 'Day 1 plan not available'}
**Day 2:** ${plan.timeline?.day2 || 'Day 2 plan not available'}

## Success Metrics

**Week 1:** ${plan.successMetrics?.week1 || 'Week 1 metrics not available'}
**Pivot Signal:** ${plan.successMetrics?.pivotSignal || 'Pivot criteria not available'}

---

**Reality Check:** ${plan.realityCheck || 'Motivational message not available'}

## Source

**Customer Pain Point:** "${originalTitle}"
**Business Opportunity:** ${opportunity}
**Original Source:** ${sourceLink}

---
*This Launch Plan was created by GrumpyLinks.com based on customer feedback.*`;
}

function showTextBasedPrd(container, formattedContent, originalTitle, opportunity, sourceLink) {
  // Fallback for text-based responses
  container.innerHTML = `
    <div class="prd-header">
      <h2 class="prd-title">üöÄ Launch Plan</h2>
      <div class="prd-actions">
        <button class="prd-action-btn" onclick="copyPrdToClipboard()">Copy Plan</button>
        <button class="prd-action-btn secondary" onclick="downloadPrd()">Download</button>
        <button class="prd-action-btn secondary" onclick="closePrd()">‚úï Close</button>
      </div>
    </div>
    
    <div class="prd-content">
      ${formattedContent}
      
      <h2>Source</h2>
      <div class="prd-source-section">
        <div class="source-item">
          <div class="source-label">Customer Pain Point:</div>
          <div class="source-text">"${escapeHtml(originalTitle)}"</div>
        </div>
        <div class="source-item">
          <div class="source-label">Business Opportunity:</div>
          <div class="source-text">${escapeHtml(opportunity)}</div>
        </div>
        <div class="source-item">
          <div class="source-label">Original Source:</div>
          <div class="source-text">${escapeHtml(sourceLink)}</div>
        </div>
      </div>
    </div>
  `;
}

function formatPrdContent(content) {
  const cleaned = content
    .replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu, '')
    .replace(/<span[^>]*>[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]<\/span>/gu, '');

  const sections = cleaned.split(/(?=^## )/gm);

  const processedSections = sections.map(section => {
    let processed = section
      .replace(/^# (.*$)/gm, '<h1>$1</h1>')
      .replace(/^## (.*$)/gm, '<h2>$1</h2>')
      .replace(/^### (.*$)/gm, '<h3>$1</h3>');
    
    const lines = processed.split('\n');
    let inNumberedList = false;
    let listItems = [];
    
    for (let i = 0; i < lines.length; i++) {
      const line = lines[i];
      
      if (/^\d+\.\s+/.test(line)) {
        const content = line.replace(/^\d+\.\s+/, '');
        listItems.push(`<li>${content}</li>`);
        inNumberedList = true;
      } else {
        if (inNumberedList && listItems.length > 0) {
          lines[i - listItems.length] = `<ol>${listItems.join('')}</ol>`;
          for (let j = 1; j < listItems.length; j++) {
            lines[i - listItems.length + j] = '';
          }
          listItems = [];
          inNumberedList = false;
        }
      }
    }
    
    if (inNumberedList && listItems.length > 0) {
      lines[lines.length - listItems.length] = `<ol>${listItems.join('')}</ol>`;
      for (let k = 1; k < listItems.length; k++) {
        lines[lines.length - listItems.length + k] = '';
      }
    }
    
    return lines.join('\n');
  });

  const result = processedSections.join('');

  return result
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.*?)\*/g, '<em>$1</em>')
    .replace(/^[-*]\s+(.*)$/gm, '<li>$1</li>')
    .replace(/(<li>(?!.*<\/ol>).*<\/li>(?:\s*<li>(?!.*<\/ol>).*<\/li>)*)/gs, '<ul>$1</ul>')
    .replace(/\n\n+/g, '</p><p>')
    .replace(/^(?!<[huo])(.+)$/gm, '<p>$1</p>')
    .replace(/<p><\/p>/g, '')
    .replace(/<p>\s*<\/p>/g, '')
    .replace(/\n\s*\n/g, '\n')
    .trim();
}

function copyPrdToClipboard() {
  if (!window.currentPrdContent) return;

  if (navigator.clipboard && window.isSecureContext) {
    navigator.clipboard.writeText(window.currentPrdContent).then(() => {
      const btn = document.querySelector('.prd-action-btn[onclick="copyPrdToClipboard()"]');
      if (btn) {
        const originalText = btn.textContent;
        btn.textContent = '‚úÖ Copied!';
        btn.style.background = 'var(--bg-success)';
        setTimeout(() => {
          btn.textContent = originalText;
          btn.style.background = 'var(--bg-button)';
        }, 2000);
      }
    }).catch(() => {
      fallbackCopyPrd();
    });
  } else {
    fallbackCopyPrd();
  }
}

function fallbackCopyPrd() {
  const textArea = document.createElement('textarea');
  textArea.value = window.currentPrdContent;
  textArea.style.position = 'fixed';
  textArea.style.left = '-999999px';
  textArea.style.top = '-999999px';
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    const successful = document.execCommand('copy');
    if (successful) {
      const btn = document.querySelector('.prd-action-btn[onclick="copyPrdToClipboard()"]');
      if (btn) {
        const originalText = btn.textContent;
        btn.textContent = '‚úÖ Copied!';
        btn.style.background = 'var(--bg-success)';
        setTimeout(() => {
          btn.textContent = originalText;
          btn.style.background = 'var(--bg-button)';
        }, 2000);
      }
    } else {
      alert('Could not copy to clipboard. Please select and copy manually.');
    }
  } catch (err) {
    alert('Could not copy to clipboard. Please select and copy manually.');
  } finally {
    document.body.removeChild(textArea);
  }
}

function downloadPrd() {
  if (!window.currentPrdContent) return;

  const productName = window.currentPrdContent.match(/^#\s+([^-\n]+)/m)?.[1]?.trim()
    ?.toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-').replace(/-+/g, '-').replace(/^-|-$/g, '') || 'product';

  const filename = `${productName}-launch-plan-${new Date().toISOString().slice(0,10)}.md`;

  const blob = new Blob([window.currentPrdContent], { type: 'text/markdown' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);

  const btn = event.target;
  const originalText = btn.textContent;
  btn.textContent = '‚úÖ Downloaded!';
  btn.style.background = 'var(--bg-success)';

  setTimeout(() => {
    btn.textContent = originalText;
    btn.style.background = 'var(--bg-tertiary)';
  }, 2000);
}

function showPrdError(errorMessage) {
  const container = getPrdContainer();
  container.innerHTML = `
    <div class="prd-header">
      <h2 class="prd-title">‚ö†Ô∏è Launch Plan Generation Failed</h2>
      <div class="prd-actions">
        <button class="prd-action-btn secondary" onclick="closePrd()">‚úï Close</button>
      </div>
    </div>
    <div class="prd-content">
      <p style="color: var(--bg-danger); text-align: center; padding: 20px;">
        Failed to generate launch plan: ${escapeHtml(errorMessage)}<br>
        <small>Please try again or check your connection.</small>
      </p>
    </div>
  `;
}

function getPrdContainer() {
  let container = document.getElementById('prd-container');
  if (!container) {
    container = document.createElement('div');
    container.id = 'prd-container';
    container.className = 'prd-container';
    
    const resultsGrid = document.getElementById('resultsGrid');
    resultsGrid.parentNode.insertBefore(container, resultsGrid.nextSibling);
  }
  return container;
}

function closePrd() {
  const container = document.getElementById('prd-container');
  if (container) container.style.display = 'none';
}

function loadDemoSearch() {
  document.getElementById('searchInput').value = DEMO_RESULTS.query;
  
  const resultsHeader = document.getElementById('resultsHeader');
  resultsHeader.style.display = 'block';
  
  displayResults(DEMO_RESULTS.results, null, DEMO_RESULTS.query, null);
}

// Initialize
function init() {
  loadConfig();
  setupEventListeners();
  document.getElementById('queryDropdown').value = '';
  document.getElementById('platformSelect').value = 'all';
  document.getElementById('timeSelect').value = 'd30';
  loadDemoSearch();
}

// Make functions global for onclick handlers
Object.assign(window, { 
  toggleFAQ, 
  downloadOpportunities, 
  copyPrdToClipboard, 
  copyFullPlanToClipboard,
  downloadPrd, 
  closePrd,
  toggleMvpPrompt,
  copyMvpPrompt
});

init();

// Dark mode functionality
function initDarkMode() {
  // Create dark mode toggle
  const toggleBtn = document.createElement('button');
  toggleBtn.className = 'dark-mode-toggle';
  toggleBtn.setAttribute('aria-label', 'Toggle dark mode');
  toggleBtn.onclick = toggleDarkMode;
  document.body.appendChild(toggleBtn);
  
  // Check for saved preference or system preference
  const savedTheme = localStorage.getItem('grumpy-theme');
  const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  
  if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
    document.body.classList.add('dark-mode');
  }
}

function toggleDarkMode() {
  const isDark = document.body.classList.toggle('dark-mode');
  localStorage.setItem('grumpy-theme', isDark ? 'dark' : 'light');
}

// Update your init() function to include:
function init() {
  loadConfig();
  setupEventListeners();
  initDarkMode(); // Add this line
  document.getElementById('queryDropdown').value = '';
  document.getElementById('platformSelect').value = 'all';
  document.getElementById('timeSelect').value = 'd30';
  loadDemoSearch();
}
</script>
</body>
</html>